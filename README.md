[![Coverage Status](https://coveralls.io/repos/github/sweetsenpai/DjangoBookingApp/badge.svg?t=12345)](https://coveralls.io/github/sweetsenpai/DjangoBookingApp)
[![Run Pytest with Docker](https://github.com/sweetsenpai/DjangoBookingApp/actions/workflows/tests.yml/badge.svg)](https://github.com/sweetsenpai/DjangoBookingApp/actions/workflows/tests.yml)
[![Django](https://img.shields.io/badge/Django-5.2-green?logo=django&logoColor=white)](https://www.djangoproject.com/)
[![DRF](https://img.shields.io/badge/DRF-3.16-blue?logo=django&logoColor=white)](https://www.django-rest-framework.org/)
[![Python 3.10](https://img.shields.io/badge/python-3.10%2B-orange?logo=python)](https://www.python.org/downloads/release/python-3100/)

# DjangoBookingApp
## ðŸ“ÐšÑ€Ð°Ñ‚ÐºÐ°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ
RestAPI Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÑŽÑ‰ÐµÐµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»:
* [Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹](#Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ-Ð¸-Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ)
* [Ð›Ð¾Ð³Ð¸Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹](#Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ-Ð¸-Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ)
* [ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚ Ð´Ð»Ñ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ](#Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ-ÐºÐ¾Ð¼Ð½Ð°Ñ‚)
* [Ð‘Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð½Ð°Ñ‚](#Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ-ÐºÐ¾Ð¼Ð½Ð°Ñ‚)
* [Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð±Ñ€Ð¾Ð½Ð¸Ð¹](#%EF%B8%8FÐ¾Ñ‚Ð¼ÐµÐ½Ð°-Ð±Ñ€Ð¾Ð½ÐµÐ¹)
* [ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð·Ð°Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚](#Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€-Ð±Ñ€Ð¾Ð½ÐµÐ¹)
* [Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð¼](#%EF%B8%8FÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ)

---
### âš™ï¸Ð¡Ñ‚ÑÐº
- Django
- DRF
- PostgreSQL
- docker-compose
- django-pytest
- Docker
- docker-compose
---
### ðŸ”ŒÐ—Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
Ð”Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ ÑÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹ Ð»ÑŽÐ±Ñ‹Ð¼ ÑƒÐ´Ð¾Ð±Ð½Ñ‹Ð¼ ÑÐ¿Ð¾ÑÐ¾Ð±Ð¾Ð¼, Ð¿Ð¾ÑÐ»Ðµ Ñ‡ÐµÐ³Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ:
1. ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
   ```commandline
   cd booking_app
   ```
2. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ `docker-compose`
    ```commandline
   docker-compose -f docker-compose.prod.yml up --build
   ```
3. Ð”Ð»Ñ Ð¿Ð¾Ð»Ð½Ð¾Ñ†ÐµÐ½Ð½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸ÐµÐ¼ Ð¿Ð¾Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÑ.
   Ð¡Ð´ÐµÐ»Ð°Ñ‚ÑŒ ÑÑ‚Ð¾ Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼:
   1. ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿ÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ django:
      ```commandline
      docker exec -it django bash
      ```
   2. Ð”Ð°Ð»ÐµÐµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð²Ð²ÐµÑÑ‚Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð½Ð¸Ð¶Ðµ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð¸ ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸ÑÐ¼ Django:
      ```commandline
         python manage.py createsuperuser
      ```

*ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾*:
Ð”Ð»Ñ ÑÐ°Ð¼Ð¾ÑÑ‚Ð¾ÑÑ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ñ‚ÐµÑÑ‚Ð¾Ð², Ð¿ÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ: 
```commandline
docker-compose -f docker-compose.test.yml up --build
```
---
### ðŸ“•Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
Ð’ÑÐµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ API Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð¸ Ð¸Ñ… Ñ€Ð°Ð±Ð¾Ñ‚Ð° Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ñ‚ÑƒÑ‚ -> [`Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ`](http://127.0.0.1:8000/api/docs/), Ð¿Ð¾ÑÐ»Ðµ ÑÑ‚Ð°Ñ€Ñ‚Ð° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ.

![API Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ](images/api_docs.png)
---

### ðŸŒ³Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
- **[`ðŸ—‚booking_app/`](booking_app/booking_app)** â€” ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ð¼Ð¸:
    - âš™ï¸ [`settings_prod`](booking_app/booking_app/settings_prod.py) â€” ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Django.
    - âš™ï¸ [`settings_dev`](booking_app/booking_app/settings_dev.py) â€” ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Django Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸.
    - âš™ï¸ [`settings_dev`](booking_app/booking_app/settings_test.py) â€” ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Django Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.
- **[`ðŸ—‚booking_app_admin/`](booking_app/booking_app_admin)** â€” ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ñ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼Ð¸ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ð¼Ð¸ Ð¿Ð°Ð½ÐµÐ»Ð¸ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°:
  - ðŸ’ƒðŸ» [`models`](booking_app/booking_app_admin/models.py) â€” ÐœÐ¾Ð´ÐµÐ»Ð¸.
  - ðŸ§™â€â™‚ï¸ [`admin`](booking_app/booking_app_admin/admin.py) â€” ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¿Ð°Ð½ÐµÐ»Ð¸ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°.
  - ðŸ¤– [`tests`](booking_app/booking_app_admin/tests) â€” Ð¢ÐµÑÑ‚Ñ‹ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹.
- **[`ðŸ—‚booking_app_api/`](booking_app/booking_app_api)** â€” ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ñ api:
  - ðŸ“Œ [`ðŸ—‚v1`](booking_app/booking_app_api/v1) â€” ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ, Ð²Ñ‹Ð½ÐµÑÐµÐ½ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð¿Ð°Ð¿ÐºÑƒ Ð´Ð»Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸ Ð²ÐµÑ€ÑÐ¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.
  - - ðŸ”ª [`serializers`](booking_app/booking_app_api/v1/serializers) â€” Ð¡ÐµÑ€Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ‚Ð¾Ñ€Ñ‹.
  - -  ðŸ’»[`views`](booking_app/booking_app_api/v1/views) â€” Views API.
  - ðŸ¤– [`tests`](booking_app/booking_app_api/tests) â€” Ð¢ÐµÑÑ‚Ñ‹.
  - âš’ï¸ [`utils`](booking_app/booking_app_api/utils) â€” Ð’ÑÐ¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ñ‹ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ API.
- **âš“ï¸[`docker-compose.prod.yml`](booking_app/docker-compose.prod.yml)** â€” `docker-compose` Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐ½ ÑÑ€ÐµÐ´Ñ‹.
- **âš“ï¸[`docker-compose.dev.yml`](booking_app/docker-compose.dev.yml)** â€” `docker-compose` Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸.
- **âš“ï¸[`docker-compose.test.yml`](booking_app/docker-compose.test.yml)** â€” `docker-compose` Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.
- **ðŸ³[`Docker.prod`](booking_app/Dockerfile.prod)** â€” `Dockerfile` Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐ½ ÑÑ€ÐµÐ´Ñ‹.
- **ðŸ³[`Docker.dev`](booking_app/Dockerfile.dev)** â€” `Dockerfile` Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¸ Ñ‚ÐµÑÑ‚Ð¾Ð².
- **ðŸ“€[`init.sql`](booking_app/init.sql)** â€” init-Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ postgresql, Ð´Ð»Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¹.
- **ðŸ“š[`logs/`](booking_app/logs)** â€” ÐŸÐ°Ð¿ÐºÐ° Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð»Ð¾Ð³Ð¾Ð², Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð° Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.
- - **[`ðŸŸ¥critical.log`]** â€” Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð¾ÑˆÐ¸Ð±Ð¾Ðº.
- - **[`ðŸŸ¨error.log`]** â€” Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾ÑˆÐ¸Ð±Ð¾Ðº.
- - **[`ðŸŸ©info.log`]** â€” Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ.



---
## ðŸ“šÐÐµ ÐºÑ€Ð°Ñ‚ÐºÐ°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ
Ð”Ð°Ð»ÐµÐµ Ð¿Ñ€Ð¾Ð¹Ð´ÑƒÑÑŒ Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð¿ÑƒÐ½ÐºÑ‚Ð°Ð¼ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð¸ Ð¾Ð¿Ð¸ÑˆÑƒ Ð¸Ñ… Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ

### ðŸ’ƒðŸ»ÐœÐ¾Ð´ÐµÐ»Ð¸
Ð”Ð»Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»Ð° Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ñ‚Ñ€Ð¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸.
1. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ - Ð² Ð¢Ð— Ð½Ðµ Ð±Ñ‹Ð»Ð¾ ÐºÐ°ÐºÐ¸Ñ…-Ñ‚Ð¾ Ð¾ÑÐ¾Ð±Ñ‹Ñ… Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ð¹ Ðº ÑÑ‚Ð¾Ð¹ Ð¼Ð¾Ð´ÐµÐ»Ð¸, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð»Ð°ÑÑŒ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ `User`

2. ÐšÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ - Ð¾Ð¿Ð¸ÑÐ°Ð½Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð°Ñ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ. Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð¿Ð¾Ð»Ñ:
   * `name` - Ð½Ð¾Ð¼ÐµÑ€/Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹
   * `price_per_day` - ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð² ÑÑƒÑ‚ÐºÐ¸. Ð”Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ð¾Ð»Ñ Ð±Ñ‹Ð» Ð²Ñ‹Ð±Ñ€Ð°Ð½ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Decimal Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¾Ð½ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ Ð½Ð°Ð¸Ð±Ð¾Ð»ÐµÐµ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¼ Ð¸ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼Ñ‹Ð¼ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð´ÐµÐ½ÑŒÐ³Ð°Ð¼Ð¸.
   * `capacity` - Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð¶Ð¸Ð²Ð°ÑŽÑ‰Ð¸Ñ… Ð² ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ðµ
     
   ```python
   class Room(models.Model):
    name = models.CharField(
        max_length=100, help_text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ/Ð½Ð¾Ð¼ÐµÑ€ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹", unique=True, blank=False
    )
    price_per_day = models.DecimalField(
        max_digits=10,
        decimal_places=2,
        validators=[MinValueValidator(Decimal("0.01"))],
        help_text="Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð·Ð° ÑÑƒÑ‚ÐºÐ¸",
    )
    capacity = models.IntegerField(
        help_text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ð½Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ð½Ð° ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ð°",
        blank=False,
        null=False,
        validators=[MinValueValidator(1)],
    )
   ```
3. Ð‘Ñ€Ð¾Ð½Ð¸ - Ð¾Ð¿Ð¸ÑÐ°Ð½Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð°Ñ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ, Ñ‚ÑƒÑ‚ ÐµÑÑ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ð¹ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ð¹ Ñ Ð¿ÐµÑ€ÐµÑÐµÑ‡ÐµÐ½Ð¸ÑÐ¼Ð¸ Ð´Ð°Ñ‚, Ð½Ð¾ ÐµÐ³Ð¾ Ð¾Ð¿Ð¸ÑˆÑƒ Ð² Ñ€Ð°Ð±Ð¾Ñ‚Ðµ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð° Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ. 
Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð¿Ð¾Ð»Ñ:
      * `date_start` - Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ Ð·Ð°ÐµÐ·Ð´Ð°
      * `date_end` - Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹ÐµÐ·Ð´Ð°
      * `room` - ÑÐ²ÑÐ·Ð°Ð½Ð½Ð¾Ðµ Ð¿Ð¾Ð»Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ `Room`
      * `user` - ÑÐ²ÑÐ·Ð°Ð½Ð½Ð¾Ðµ Ð¿Ð¾Ð»Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ `User`
      * Ð¾Ð±Ðµ ÑÐ²ÑÐ·Ð¸ `many-to-one`

   ```python
   class Booking(models.Model):
    date_start = models.DateTimeField()
    date_end = models.DateTimeField()
    room = models.ForeignKey(Room, on_delete=models.CASCADE)
    user = models.ForeignKey(User, on_delete=models.CASCADE)

    class Meta:
        constraints = [
            ExclusionConstraint(
                name="exclude_overlapping_booking",
                expressions=[
                    (
                        TsTzRange("date_start", "date_end", RangeBoundary()),
                        RangeOperators.OVERLAPS,
                    ),
                    ("room", RangeOperators.EQUAL),
                ],
            )
        ]

    def __str__(self):
        return f"{self.user.username} â€“ {self.room.name} â€“ {self.date_start:%Y-%m-%d}"
   ```
   ÐŸÑ€Ð¾ÐµÐºÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð² ÑÐµÐ±Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ postgresql Ñ `exclusion constraint`.
---
## ðŸ Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð¼Ð½Ð°Ñ‚
**Ð—Ð°Ð´Ð°Ñ‡Ð°**
```
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ¼ÐµÑ‚ÑŒ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð¿Ð¾ Ñ†ÐµÐ½Ðµ, Ð¿Ð¾
ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ Ð¼ÐµÑÑ‚.
ÐŸÑ€Ð¾ÑÐ¼Ð°Ñ‚Ñ€Ð¸Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð¼Ð¾Ð¶Ð½Ð¾ Ð±ÐµÐ· Ð»Ð¾Ð³Ð¸Ð½Ð°.
```
**Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ**

ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ñ… Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼Ð¾Ð² `DRF`.
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ `ListAPIView` Ð´Ð»Ñ Ð²Ñ‹Ð´Ð°Ñ‡Ð¸ ÑÐ¿Ð¸ÑÐºÐ° Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð² Ð¸ `OrderingFilter` Ñ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼Ð¸ `ordering_fields = ["price_per_day", "capacity"]` Ð´Ð»Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ñ†ÐµÐ½Ðµ Ð¸ Ð²Ð¼ÐµÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸.
Ð­Ð½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð´Ð»Ñ Ð»ÑŽÐ±Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ñ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑÐ¼Ð¸.

```python
class ShowRoomsApi(ListAPIView):
    """
    API endpoint - Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¸Ð· Ð²ÑÐµÑ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚,
    Ñ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒÑŽ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ð¿Ð¾ Ð¿Ð¾Ð»ÑÐ¼ price_per_day Ð¸ capacity.

    ÐšÐ°Ð¶Ð´Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ ÑÐ¿Ð¸ÑÐºÐ° ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ id, name, price_per_day, capacity.
    """

    queryset = Room.objects.all()
    serializer_class = RoomSerializer
    filter_backends = [OrderingFilter]
    ordering_fields = ["price_per_day", "capacity"]
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ ÐºÐ¾Ð¼Ð½Ð°Ñ‚](images/api_filter_rooms.png)
---
## ðŸ”ŽÐŸÐ¾Ð¸ÑÐº ÐºÐ¾Ð¼Ð½Ð°Ñ‚
**Ð—Ð°Ð´Ð°Ñ‡Ð°**
```
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ¼ÐµÑ‚ÑŒ Ð¸ÑÐºÐ°Ñ‚ÑŒ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð² Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¼ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ðµ.
ÐŸÑ€Ð¾ÑÐ¼Ð°Ñ‚Ñ€Ð¸Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð¼Ð¾Ð¶Ð½Ð¾ Ð±ÐµÐ· Ð»Ð¾Ð³Ð¸Ð½Ð°.
```
**Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ**

Ð”Ð»Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ ÐºÐ¾Ð¼Ð½Ð°Ñ‚ Ð¿Ð¾ Ð·Ð°Ð´Ð°Ð½Ñ‹Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¼ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚ÐºÐ°Ð¼ Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ð° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ `get_free_rooms` - ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð½Ð° Ð²Ñ…Ð¾Ð´ Ð´Ð°Ñ‚Ñƒ Ð·Ð°ÐµÐ·Ð´Ð° Ð¸ Ð´Ð°Ñ‚Ñƒ Ð²Ñ‹ÐµÐ·Ð´Ð°.
Ð”Ð°Ð»ÐµÐµ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ð¾Ð¹ Ð² Django ORM Ð´ÐµÐ»Ð°ÐµÑ‚ÑÑ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð² Ð±Ð´ Ð½Ð° Ð²Ñ‹Ð´Ð°Ñ‡Ñƒ Ð²ÑÐµÑ… Ð¿ÐµÑ€ÐµÑÐµÐºÐ°ÑŽÑ‰Ð¸Ñ…ÑÑ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¹, Ð° Ð·Ð°Ñ‚ÐµÐ¼ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ñ Ñ‚Ð°ÐºÐ¸Ð¼Ð¸ Ð±Ñ€Ð¾Ð½ÑÐ¼Ð¸ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¸ÑÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‚ÑÑ Ð¸Ð· Ð¾Ð±Ñ‰ÐµÐ¹ Ð²Ñ‹Ð´Ð°Ñ‡Ð¸.

```python
def get_free_rooms(date_start: datetime, date_end: datetime) -> QuerySet:
    """
    ÐŸÐ¾Ð¸ÑÐº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚ Ð² Ð·Ð°Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚Ð¾Ðº.
     
    :param date_start: Ð´Ð°Ñ‚Ð° Ð·Ð°ÐµÐ·Ð´Ð°
    :param date_end: Ð´Ð°Ñ‚Ð° Ð²Ñ‹ÐµÐ·Ð´Ð°
    :return: Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ QuerySet Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ð¼Ð¸ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ð°Ð¼Ð¸ Ð¿Ð¾ Ð·Ð°Ð´Ð°Ð½Ñ‹Ð¼ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼
    """

    busy_rooms = Booking.objects.filter(
        Q(date_start__lt=date_end) & Q(date_end__gt=date_start)
    ).values_list("room_id", flat=True)
    free_rooms = Room.objects.exclude(id__in=busy_rooms)
    return free_rooms
```

Ð’ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÑÐµÑ€Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ‚Ð¾Ñ€, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ Ñ‚Ð¸Ð¿Ð°Ð¼ Ð¸ Ñ‡Ñ‚Ð¾ Ð²ÑÐµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ Ð¿Ð¾Ð»Ñ Ð¿Ñ€Ð¸ÑÑƒÐ´ÑÑ‚Ð²ÑƒÑŽÑ‚.
Ð¢Ð°Ðº Ð¶Ðµ Ð¸Ð´ÐµÑ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚ÐºÐ° - Ð´Ð°Ñ‚Ð° Ð·Ð°ÐµÐ·Ð´Ð° Ð½Ðµ Ð¿Ð¾Ð·Ð¶Ð¸ Ð´Ð°Ñ‚Ñ‹ Ð²Ñ‹ÐµÐ·Ð´Ð°, Ð´Ð°Ñ‚Ð° Ð²Ñ‹ÐµÐ·Ð´Ð° Ð½Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒÑÑ Ð² Ð¿Ñ€Ð¾ÑˆÐ»Ð¾Ð¼.
ÐžÑ‚ ÑÐµÐ±Ñ Ð´Ð¾Ð±Ð°Ð²Ð¸Ð» Ð² Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð°  Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð²Ð¼ÐµÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ ÐºÐ¾Ð¼Ð½Ð°Ñ‚, ÑÑ‚Ð¾Ñ‚ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ðµ Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ñ‚ÑŒ Ð¾Ð½ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹.
Ð­Ð½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð´Ð»Ñ Ð»ÑŽÐ±Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ñ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑÐ¼Ð¸.

```python
class RoomSearchParamsSerializer(serializers.Serializer):
    date_start = serializers.DateTimeField(required=True)
    date_end = serializers.DateTimeField(required=True)
    capacity = serializers.IntegerField(required=False, min_value=0, default=0)

    def validate(self, data):
        if data["date_start"] > data["date_end"]:
            raise serializers.ValidationError(
                "Ð”Ð°Ñ‚Ð° Ð·Ð°ÐµÐ·Ð´Ð° Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ð¾Ð·Ð¶Ðµ Ð´Ð°Ñ‚Ñ‹ Ð²Ñ‹ÐµÐ·Ð´Ð°."
            )
        if data["date_end"].date() < date.today():
            raise serializers.ValidationError("Ð”Ð°Ñ‚Ð° Ð²Ñ‹ÐµÐ·Ð´Ð° Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð² Ð¿Ñ€Ð¾ÑˆÐ»Ð¾Ð¼.")
        return data
```
ÐšÐ¾Ð´ Ð²ÑÐµÐ³Ð¾ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð°:
```python
class SearchFreeRoomApi(APIView):
    """
    API endpoint Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚.

    Ð­Ñ‚Ð¾Ñ‚ endpoint Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚
    Ð´Ð»Ñ Ð°Ñ€ÐµÐ½Ð´Ñ‹ Ð² Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¼ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚ÐºÐµ. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð´Ð¾Ð»Ð¶ÐµÐ½
    ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð¸ ÐºÐ¾Ð½ÐµÑ‡Ð½ÑƒÑŽ Ð´Ð°Ñ‚Ñ‹ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¼Ð¾Ð¶ÐµÑ‚
    Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð·Ð°Ð´Ð°Ñ‚ÑŒ Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹. 
    
    ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° (query parameters):
    - date_start (Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹): ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð°Ñ‚Ð° Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ YYYY-MM-DD.
    - date_end (Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹): ÐšÐ¾Ð½ÐµÑ‡Ð½Ð°Ñ Ð´Ð°Ñ‚Ð° Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ YYYY-MM-DD.
    - capacity (Ð½ÐµÐ¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹): ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ñ‚Ñ€ÐµÐ±ÑƒÐµÐ¼Ð°Ñ Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹.
    """

    def get(self, request):
        serializer = RoomSearchParamsSerializer(data=request.query_params)
        serializer.is_valid(raise_exception=True)

        validated = serializer.validated_data
        date_start = validated["date_start"]
        date_end = validated["date_end"]
        capacity = validated["capacity"]

        free_rooms = get_free_rooms(date_start, date_end).filter(capacity__gte=capacity)
        serializer = RoomSerializer(free_rooms, many=True)

        return Response(serializer.data)
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¿Ð¾Ð¸ÑÐº ÐºÐ¾Ð¼Ð½Ð°Ñ‚](images/api_search_rooms.png)
---
## ðŸ”’Ð‘Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð½Ð°Ñ‚
**Ð—Ð°Ð´Ð°Ñ‡Ð°**

```
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ¼ÐµÑ‚ÑŒ Ð·Ð°Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½ÑƒÑŽ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñƒ.
Ð§Ñ‚Ð¾Ð±Ñ‹ Ð·Ð°Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼Ð¸.
```
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ**

Ð Ð°Ð±Ð¾Ñ‚Ð° ÑÑ‚Ð¾Ð³Ð¾ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð° Ð¿Ð¾ÐºÐ°Ð·Ð°Ð»Ð°ÑÑŒ Ð¼Ð½Ðµ ÑÐ°Ð¼Ð¾Ð¹ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ð¾Ð¹.

Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð´Ð»Ñ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð½Ð°Ñ‚ ÑƒÐ¶Ðµ Ð½Ð°Ð¿Ð¸ÑÐ°Ð½ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð¸ ÐµÑÐ»Ð¸ Ð² ÑÑ‚Ð¾Ð¼ ÐºÐ¾Ð´Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿ÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ,
Ñ‚Ð¾ Ð²ÑÑ‚Ð°Ð½ÐµÑ‚ Ð²Ð¾Ð¿Ñ€Ð¾Ñ "ÐšÐ°Ðº Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ñ‚ÑŒ Ð°Ñ‚Ð¾Ð¼Ð°Ñ€Ð½Ð¾ÑÑ‚ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ?" -Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ Ð¿Ñ€Ð¾Ð³Ð¾Ð½ Ð¿Ð¾ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñƒ Ð¸ Ð´Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÐ°Ñ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð½Ðµ Ð»ÑƒÑ‡ÑˆÐ¸ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¼ÐµÐ¶Ð´Ñƒ 
Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ð¹ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð° Ð¸ Ð·Ð°Ð¿Ð¸ÑÑŒÑŽ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ Ð²Ñ€ÐµÐ¼Ñ Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ ÑƒÑÐ¿ÐµÑ‚ÑŒ Ð²ÐºÐ»Ð¸Ð½Ð¸Ñ‚ÑŒÑÑ ÐµÑ‰Ñ‘ Ð¾Ð´Ð½Ð° Ð±Ñ€Ð¾Ð½ÑŒ. 

Ð˜Ð·Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð´ÐµÐµÐ¹ Ð±Ñ‹Ð»Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ `atomic`, Ð½Ð¾ Ð¾Ð½ Ð»Ð¸Ð±Ð¾ Ñ‚Ð°Ðº Ð¶Ðµ Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð²Ñ€ÐµÐ¼Ñ Ð¼ÐµÐ¶Ð´Ñƒ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¾Ð¹ Ð¸ Ð·Ð°Ð¿Ð¸ÑÑŒÑŽ, Ð»Ð¸Ð±Ð¾ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð±Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÑ‚ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ - Ñ‡Ñ‚Ð¾ ÐµÑ‰Ñ‘ Ñ…ÑƒÐ¶Ðµ.

ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼ Ñ€ÐµÑˆÐµÐ½Ð¸ÐµÐ¼ Ð¾ÐºÐ°Ð·Ð°Ð»Ð¾ÑÑŒ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ Ð‘Ð” Ð¸ Ñ‚Ð°ÐºÐ¾Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð¾Ð¿Ð¸ÑÐ°Ð½ Ð² [Ð¾Ñ„Ð¸Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸](https://docs.djangoproject.com/en/5.1/ref/contrib/postgres/constraints/), Ð½Ð¾ ÑÑ‚Ð¾Ð¸Ñ‚ ÑƒÑ‡ÐµÑÑ‚ÑŒ Ñ‡Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ postgresql

Ð’Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ ÑÐ°Ð¼Ð¾Ð¹ Ð‘Ð” Ð½Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð¿ÐµÑ€ÐµÑÐµÐºÐ°ÑŽÑ‰Ð¸Ñ…ÑÑ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ð¾Ð² Ð´Ð»Ñ Ð¾Ð´Ð½Ð¾Ð¹ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ñ‚Ð¼ÐµÐ½ÑÐµÑ‚ Ð·Ð°Ð¿Ð¸ÑÐ¸ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¿Ñ‹Ñ‚Ð°ÑŽÑ‚ÑÑ ÐµÐ³Ð¾ Ð½Ð°Ñ€ÑƒÑˆÐ¸Ñ‚ÑŒ. 
Ð¢Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ñ‚ÑŒ Ð°Ñ‚Ð¾Ð¼Ð°Ñ€Ð½Ð¾ÑÑ‚ÑŒ ÑÑ‚Ð¾Ð¹ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸.

Ð’ Ð·Ð°Ð´Ð°Ð½Ð¸Ð¸ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð¾Ð³Ð»Ð¸ Ð¾ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð»ÑÑ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð¸ ÑÑ‚Ð¾ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ÑÑ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ
`permission_classes = [IsAuthenticated]`.
Ð¢Ð°ÐºÐ¶Ðµ Ñ Ð´Ð¾Ð±Ð°Ð²Ð¸Ð» `throttling` Ð½Ð° 100 Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð² ÑÑƒÑ‚ÐºÐ¸ Ñ Ð¾Ð´Ð½Ð¾Ð³Ð¾ IP, Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°Ñ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð·Ð°Ñ‰Ð¸Ñ‚Ñƒ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°.

Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ñ ÑƒÐ´Ð¾Ð±Ð¾Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ñ‹Ð¼ Ð²Ñ‹Ð²Ð¾Ð´Ð¾Ð¼ Ð¸ Ð¿Ñ€ÐµÐ´ÑƒÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð° Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ½Ð¾Ð²ÐµÐ½Ð¸Ñ Ð½ÐµÐ¿Ñ€ÐµÐ´Ð²Ð¸Ð´ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÑˆÐ¸Ð±Ð¾Ðº.


Ð¡Ð°Ð¼ ÐºÐ¾Ð´ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð°:

```python
class CreateBookingApi(APIView):
    """
    API Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð¹ Ð±Ñ€Ð¾Ð½Ð¸.

    Ð­Ñ‚Ð¾Ñ‚ API Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð´Ð»Ñ ÐºÐ¾Ð¼Ð½Ð°Ñ‚ Ð½Ð° Ð·Ð°Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð°Ñ‚Ñ‹.
    Ð‘Ñ€Ð¾Ð½ÑŒ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸ÐµÐ¼ Ð´Ð°Ñ‚Ñ‹ Ð½Ð°Ñ‡Ð°Ð»Ð°, Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ Ð¸ id Ð½Ð¾Ð¼ÐµÑ€Ð°. Ð’ ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¾ÑˆÐ¸Ð±Ð¾Ðº, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ÑÑ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
    Ñ ÐºÐ¾Ð´Ð°Ð¼Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°.

    Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹, Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° Ð´Ð°Ñ‚ Ð¸ Ð¿ÐµÑ€ÐµÑÐµÑ‡ÐµÐ½Ð¸Ñ Ð±Ñ€Ð¾Ð½ÐµÐ¹.
    """
    permission_classes = [IsAuthenticated]
    throttle_classes = [BookingThrottle]
    serializer_class = BookingCreateSerializer

    def post(self, request):
        """
        ÐœÐµÑ‚Ð¾Ð´ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð¹ Ð±Ñ€Ð¾Ð½Ð¸.
    
        Ð­Ñ‚Ð¾Ñ‚ Ð¼ÐµÑ‚Ð¾Ð´ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ POST-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð¹ Ð±Ñ€Ð¾Ð½Ð¸. 
        ÐŸÐ¾ÑÐ»Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ð±Ñ€Ð¾Ð½ÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…. 
        Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ ÐºÐ¾Ð´Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‚Ð°:
        - 201: Ð£ÑÐ¿ÐµÑˆÐ½Ð¾Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð¹ Ð±Ñ€Ð¾Ð½Ð¸.
        - 400: ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ….
        - 409: ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚. ÐšÐ¾Ð¼Ð½Ð°Ñ‚Ð° ÑƒÐ¶Ðµ Ð·Ð°Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð°Ñ‚.
        - 503: ÐÐµÐ¿Ñ€ÐµÐ´Ð²Ð¸Ð´ÐµÐ½Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° ÑÐµÑ€Ð²Ð¸ÑÐ°.
    
        ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹:
        - room (int): Ð˜Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹.
        - date_start (datetime): ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð±Ñ€Ð¾Ð½Ð¸.
        - date_end (datetime): ÐšÐ¾Ð½ÐµÑ† Ð±Ñ€Ð¾Ð½Ð¸.
        """
        serializer = self.serializer_class(data=request.data)
        serializer.is_valid(raise_exception=True)
        try:
            with transaction.atomic():
                serializer.validated_data["user"] = request.user
                serializer.save()
                logger.info(
                    f"ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ id  {request.user.id} ÑÐ¾Ð·Ð´Ð°Ð» Ð½Ð¾Ð²Ð¾Ðµ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ {serializer.data}"
                )
                return Response(serializer.data, status=status.HTTP_201_CREATED)
        # ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð¾Ñ‚ postgresql Ð¿Ñ€Ð¸ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¿ÐµÑ€ÐµÑÐµÐºÐ°ÑŽÑ‰Ð¸Ñ…ÑÑ Ð±Ñ€Ð¾Ð½ÐµÐ¹.
        except IntegrityError:
            return Response(
                {
                    "detail": "ÐšÐ¾Ð¼Ð½Ð°Ñ‚Ð° ÑƒÐ¶Ðµ Ð·Ð°Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð´Ð°Ñ‚Ñ‹ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸Ð»Ð¸ Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´Ñ€ÑƒÐ³ÑƒÑŽ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñƒ."
                },
                status=status.HTTP_409_CONFLICT,
            )
        except Exception as e:
            logger.error(
                "Ð’Ð¾ Ð²Ñ€ÐµÐ¼Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð½ÐµÐ¿Ñ€ÐµÐ´Ð²Ð¸Ð´ÐµÐ½Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°:\n"
                f"user: {request.user}\n"
                f"data: {request.data}\n"
                f"error: {str(e)}\n"
                f"error_type: {type(e)}"
            )
            return Response(
                {
                    "detail": "Ð¡ÐµÑ€Ð²Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½.ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð¸ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ñ‘ Ñ€Ð°Ð·."
                },
                status=status.HTTP_503_SERVICE_UNAVAILABLE,
            )
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð½Ñ‚Ð°](images/api_create_booking.png)
---

## ðŸ‘€ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð±Ñ€Ð¾Ð½ÐµÐ¹
**Ð—Ð°Ð´Ð°Ñ‡Ð°**
```
ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð²Ð¸Ð´ÐµÑ‚ÑŒ ÑÐ²Ð¾Ð¸ Ð±Ñ€Ð¾Ð½Ð¸.
```
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½ `permission_classes = [IsAuthenticated]` Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ. 
ÐŸÐµÑ€ÐµÐ¿Ð¸ÑÐ°Ð½ `get_queryset` Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð²Ñ‹Ð´Ð°Ð²Ð°Ð»Ð¸ÑÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ**

```python
class UserAllBookingApi(ListAPIView):
    """
    API endpoint Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ Ð²ÑÐµÑ… Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑÑ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
    
    Endpoint Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹.
    
    Ð­Ñ‚Ð¾Ñ‚ endpoint Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð² Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ ÑÐ²ÑÐ·Ð°Ð½Ð½ÑƒÑŽ Ñ Ð½Ð¸Ð¼ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñƒ,
    Ð¿Ð¾ ÐµÐ³Ð¾ id.

    ÐžÐ±ÑŠÐµÐºÑ‚ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð² ÑÐµÐ±Ðµ Ð¿Ð¾Ð»Ñ id, date_start, date_end, room(id, name, capacity, price_per_day).
    """
    permission_classes = [IsAuthenticated]
    queryset = Booking.objects.all().prefetch_related("room")
    serializer_class = BookingSerializer

    def get_queryset(self):
        return Booking.objects.filter(user=self.request.user).prefetch_related("room")
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð½Ñ‚Ð°](images/api_show_booking.png)
---
## ðŸ§™â€â™‚ï¸Ð¡ÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ
**Ð—Ð°Ð´Ð°Ñ‡Ð°**
```
Ð¡ÑƒÐ¿ÐµÑ€ÑŽÐ·ÐµÑ€ Ð´Ð¾Ð»Ð¶ÐµÐ½ ÑƒÐ¼ÐµÑ‚ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ/ÑƒÐ´Ð°Ð»ÑÑ‚ÑŒ/Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹ Ð¸ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¾ Ð±Ñ€Ð¾Ð½ÑÑ… Ñ‡ÐµÑ€ÐµÐ· Ð°Ð´Ð¼Ð¸Ð½ Ð¿Ð°Ð½ÐµÐ»ÑŒ Django.
```
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ**

ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð² Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ÑÐºÑƒÑŽ Ð¿Ð°Ð½ÐµÐ»ÑŒ Django, Ð²ÐµÑÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð» ÑƒÐ¶Ðµ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½ Ð² ÑÐ°Ð¼Ð¾Ð¼ Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€ÐºÐµ.
Ðž Ð¿ÐµÑ€ÐµÑÐ¸Ñ‡ÐµÐ½Ð¸Ð¸ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ðµ Ð¿ÐµÑ€ÐµÐ¶Ð¸Ð²Ð°Ñ‚ÑŒ Ð¸Ð·-Ð·Ð° Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ Ð‘Ð” Ð¾Ð¿Ð¸ÑÐ°Ð½Ð½Ð¾Ð³Ð¾ Ð²Ñ‹ÑˆÐµ.

ÐšÐ¾Ð´:
```python
@admin.register(Room)
class RoomAdmin(admin.ModelAdmin):
    list_display = ("id", "name", "price_per_day", "capacity")
    list_filter = ("price_per_day", "capacity")


@admin.register(Booking)
class BookingAdmin(admin.ModelAdmin):
    list_display = ("id", "room", "user", "date_start", "date_end")
    list_filter = ("room", "user", "date_start")
    search_fields = ("room__name", "user__username")
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð±Ñ€Ð¾Ð½ÐµÐ¹](images/admin.png)
---
## ðŸ™…â€â™‚ï¸ÐžÑ‚Ð¼ÐµÐ½Ð° Ð±Ñ€Ð¾Ð½ÐµÐ¹
**Ð—Ð°Ð´Ð°Ñ‡Ð°**
```
Ð‘Ñ€Ð¾Ð½Ð¸ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ñ‹ ÐºÐ°Ðº ÑÐ°Ð¼Ð¸Ð¼ ÑŽÐ·ÐµÑ€Ð¾Ð¼, Ñ‚Ð°Ðº Ð¸ ÑÑƒÐ¿ÐµÑ€ÑŽÐ·ÐµÑ€Ð¾Ð¼.
```
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ**

Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð» ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð¹ Ð±Ñ€Ð¾Ð½Ð¸ Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð» Ð² Ð½ÐµÐ¼ Ð¼ÐµÑ‚Ð¾Ð´ `destroy`.
Ð”Ð»Ñ Ñ‚Ð¾Ð³Ð¾ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ð»Ð°Ð´ÐµÐ»Ð¸Ñ† Ð¸Ð»Ð¸ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð» ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ð¹ `permission_classes = [IsOwnerOrSuperUser]`

```python
class IsOwnerOrSuperUser(BasePermission):
    def has_object_permission(self, request, view, obj):
        return request.user == obj.user or request.user.is_superuser
```
Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ `get_object` Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¾Ð±ÑŠÐµÐºÑ‚ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð±ÑƒÐ´ÐµÐ¼ ÑƒÐ´Ð°Ð»ÑÑ‚ÑŒ, Ð¸ Ð·Ð°Ñ€Ð°Ð½Ð¸Ðµ ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚ÐµÐºÑÑ‚ Ð´Ð»Ñ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ð¾Ð± ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ð¸ Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¿Ð¾Ñ‚Ð¾Ð¼ Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒÑÑ ÑÐ¾ÑÐ»Ð°Ñ‚ÑŒÑÑ Ð½Ð° Ð¾Ð±ÑŠÐµÐºÑ‚.

ÐšÐ¾Ð´:
```python
class UserBookingApi(RetrieveDestroyAPIView):
    """
    API endpoint Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¸ Ñ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒÑŽ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð±Ñ€Ð¾Ð½Ð¸.
    
    Endpoint Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†Ð° Ð±Ñ€Ð¾Ð½Ð¸ Ð¸ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
    
    Ð­Ñ‚Ð¾Ñ‚ endpoint Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¾Ð±ÑŠÐµÐºÑ‚ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ ÑÐ²ÑÐ·Ð°Ð½Ð½ÑƒÑŽ Ñ Ð½Ð¸Ð¼ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñƒ,
    Ð¿Ð¾ ÐµÐ³Ð¾ id, Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¼ÐµÑ‚Ð¾Ð´Ð° delete Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ.

    ÐžÐ±ÑŠÐµÐºÑ‚ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð² ÑÐµÐ±Ðµ Ð¿Ð¾Ð»Ñ id, date_start, date_end, room(id, name, capacity, price_per_day).
    """
    queryset = Booking.objects.all().select_related("room")
    serializer_class = BookingSerializer
    permission_classes = [IsOwnerOrSuperUser]

    def destroy(self, request, *args, **kwargs):
        instance = self.get_object()
        response_text = f"Ð‘Ñ€Ð¾Ð½ÑŒ Ñ id {instance.id} ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑƒÐ´Ð°Ð»ÐµÐ½Ð°."
        self.perform_destroy(instance)
        return Response({"detail": response_text}, status=status.HTTP_200_OK)
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ð¼ÐµÐ½Ð° Ð±Ñ€Ð¾Ð½Ð¸](images/api_delete_booking.png)
---
## ðŸ›‚Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¸ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ
**Ð—Ð°Ð´Ð°Ñ‡Ð°**
```
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ¼ÐµÑ‚ÑŒ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ð¸ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ (Ð»Ð¾Ð³Ð¸Ð½Ð¸Ñ‚ÑŒÑÑ).
```
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ**

Ð”Ð»Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð» jwt-Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ simplejwt.
Ð”Ð»Ñ ÑƒÐ´Ð¾Ð±ÑÑ‚Ð²Ð° Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð» ÑÑ€Ð¾Ðº Ð¶Ð¸Ð·Ð½Ð¸ Ð´Ð»Ñ `ACCESS_TOKEN` - 2 Ñ‡Ð°ÑÐ°.

Ð ÐµÑˆÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸.
Ð”Ð²Ð° ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð°, Ð¾Ð´Ð¸Ð½ - Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ñ‚Ð¾ÐºÐµÐ½Ð°, Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ - Ð´Ð»Ñ ÐµÐ³Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ.
```python
path("api/token/", TokenObtainPairView.as_view(), name="token_obtain_pair"),
path("api/token/refresh/", TokenRefreshView.as_view(), name="token_refresh")
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ](images/api_token.png)
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ](images/api_refresh_token.png)
Ð›Ð¾Ð³Ð¸ÐºÐ° Ð²Ñ‹Ñ…Ð¾Ð´Ð° Ð¿Ð¾ Ð·Ð°Ð´Ð°Ð½Ð¸ÑŽ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð°, Ð° Ð½Ð° Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐµ Ñ€ÐµÑˆÐ°ÐµÑ‚ÑÑ Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´Ð°, Ñ‡ÐµÑ€ÐµÐ· Ð±ÑÐºÐµÐ½Ð´ Ñ€ÐµÑˆÐ°ÐµÑ‚ÑÑ ÐºÐ¾ÑÑ‚Ñ‹Ð»ÑÐ¼Ð¸ Ñ Ñ‡ÐµÑ€Ð½Ñ‹Ð¼ ÑÐ¿Ð¸ÑÐºÐ¾Ð¼.

Ð”Ð»Ñ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚. Ð¢ÑƒÑ‚ Ñ Ð²ÑÑŽ Ð»Ð¾Ð³Ð¸ÐºÑƒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¾Ð±ÐµÑ€Ð½ÑƒÐ» Ð² Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸ÑŽ - ÑÐ´ÐµÐ»Ð°Ð½Ð¾ ÑÑ‚Ð¾ Ð´Ð»Ñ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ Ð½Ðµ ÑÐ²ÑÐ·Ð°Ð½Ð½Ð¾Ð¹ Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ð¹ Ð±Ð´ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ð» 
Ð¾ÑˆÐ¸Ð±ÐºÑƒ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¸ Ñ‚Ð¾Ð¼ Ñ‡Ñ‚Ð¾ ÐµÐ³Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑƒÐ¶Ðµ Ð² Ð‘Ð”.

Ð”Ð¾Ð±Ð°Ð²Ð¸Ð» Ñ‚Ñ€Ð¾Ñ‚Ð»Ð¸Ð½Ð³ Ð´Ð»Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°.
ÐŸÑ€Ð¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¾Ñ‚Ð´Ð°ÐµÑ‚ÑÑ Ñ‚Ð¾ÐºÐµÐ½ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ Ð¼Ð¾Ð³ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼ ÑƒÐ¶ÐµÐ½ ÐºÐ°Ðº Ñ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼.

ÐšÐ¾Ð´:
```python
class UserRegistrationApi(generics.CreateAPIView):
    """
    API ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚ Ð´Ð»Ñ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.

    Ð”Ð°Ð½Ð½Ñ‹Ð¹ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ñ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ (username, password, password2, email),
    Ð²Ð°Ð»Ð¸Ð´Ð¸Ñ€ÑƒÐµÑ‚ Ð¸Ñ… Ð¸ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ access_token Ð¿Ñ€Ð¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸.


    ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ:
    - Ð­Ñ‚Ð¾Ñ‚ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð±ÐµÐ· Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸.
    - Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð² Ð¿Ð¾Ð»Ðµ password Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ´Ð¾Ð²Ð»ÐµÑ‚Ð²Ð¾Ñ€ÑÑ‚ÑŒ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑÐ¼ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ (Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð»Ð¸Ð½Ð°, ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ).
    """

    queryset = get_user_model().objects.all()
    permission_classes = [AllowAny]
    serializer_class = RegistrationSerializer
    throttle_classes = [UserRegistrationThrottle]

    def create(self, request, *args, **kwargs):
        serializer = self.serializer_class(data=request.data)
        try:
            with transaction.atomic():
                serializer.is_valid(raise_exception=True)
                user = serializer.save()
                refresh = RefreshToken.for_user(user)
                response_data = {
                    "access_token": str(refresh.access_token),
                }
                return Response(response_data, status=status.HTTP_201_CREATED)
        except ValidationError:
            raise

        except Exception as e:  # pragma: no cover
            logger.error(
                "Ð’Ð¾Ð²Ñ€ÐµÐ¼Ñ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¿Ñ€Ð¾Ð¸Ñ‰Ð¾ÑˆÐ»Ð° Ð½ÐµÐ¿Ñ€ÐµÐ´Ð²Ð¸Ð´ÐµÐ½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°.\n"
                f"data: {request.data}\n"
                f"error: {str(e)}"
            )
            return Response(
                {"detail": "ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð½ÐµÐ¿Ñ€ÐµÐ´Ð²Ð¸Ð´ÐµÐ½Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð´Ð½ÐµÐµ."},
                status=status.HTTP_500_INTERNAL_SERVER_ERROR,
            )
```
![Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ](images/api_registration.png)
---

## ðŸ‘‹ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ÑÑ

---
### ÐÐ²Ñ‚Ð¾Ñ‚ÐµÑÑ‚Ñ‹
Ð¢ÐµÑÑ‚Ñ‹ Ð¿Ñ€Ð¾Ð³Ð¾Ð½ÑÑŽÑ‚ÑÑ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ðµ Ñ‚Ð°Ðº ÐºÐ°Ðº Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼ postgresql.
ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ð¼Ð¾Ð¶Ð½Ð¾ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ ÑÐ°Ð¼Ð¾ÑÑ‚Ð¾ÑÑ‚ÐµÐ»ÑŒÐ½Ð¾ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:
```commandline
docker-compose -f docker-compose.test.yml up --build
```

Ð¢Ð°Ðº Ð¶Ðµ Ñ‚ÐµÑÑ‚Ñ‹ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÑŽÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÑÑ… Ð² Ð²ÐµÑ‚ÐºÐµ `main` Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ `github workflows`. 
ÐŸÐ¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ñ‚ÐµÑÑ‚Ð¾Ð² Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ Ð½Ð° [coveralls.io](https://coveralls.io/github/sweetsenpai/DjangoBookingApp)

ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ ÑÐ¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ 100%.

Ð¢ÐµÑÑ‚Ñ‹ Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ñ‹ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ `pytest-django`.
Ð¡ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÐµÐ¹ pytest Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¸Ñ‚ÑŒÑÑ Ñ‚ÑƒÑ‚:
* [conftest.pyðŸ“](booking_app/conftest.py)
* [pytest.iniðŸ“](booking_app/pytest.ini)
* [settings_test.pyðŸ“](booking_app/booking_app/settings_test.py)

### Ð›Ð¸Ð½Ñ‚ÐµÑ€
ÐŸÑ€Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ñ‚ÐµÑÑ‚Ð¾Ð² Ñ‚Ð°Ðº Ð¶Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ pylint. ÐÐ° Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ð¾Ñ†ÐµÐ½ÐºÐ° ÐºÐ¾Ð´Ð° `8.7/10`.
Ð¡ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÐµÐ¹ pytest Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¸Ñ‚ÑŒÑÑ Ñ‚ÑƒÑ‚:
* [pylintrcðŸ“](booking_app/.pylintrc)

UPD:
Ðš ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ Ð¿Ñ€Ð¸ÑˆÐ»Ð¾ÑÑŒ ÑƒÐ±Ñ€Ð°Ñ‚ÑŒ pylint Ð¸Ð· workflow Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¾Ð½ Ð¿Ñ€Ð¸Ð²Ð¾Ð´Ð¸Ð» Ðº Ð½ÐµÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ, Ð²Ñ€ÐµÐ¼Ñ Ð¾Ñ‚ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð° Ñ ÐºÐ¾Ð´Ð¾Ð¼ 22.

### ÐÐ²Ñ‚Ð¾Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð°

ÐÐ° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð»Ð¸ÑÑŒ isort Ð¸ black.
Ð˜Ñ… ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ñ‚ÑƒÑ‚: 
* [pyproject.tomlðŸ“](booking_app/pyproject.toml)

---
## Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾
Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð½Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ Ð±Ñ‹Ð»Ð¾ Ð±Ñ‹ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ:
* `celery` - Ð´Ð»Ñ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡
* `reddis` - Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ ÐºÑÑˆÐ° Ð¸ Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð±Ñ€Ð¾ÐºÐµÑ€Ð° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹.
* `senrty` - Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¾ÑˆÐ¸Ð±Ð¾Ðº.
* `grafana + prometheus` - Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°.
* `flower` - Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° `celery`.
